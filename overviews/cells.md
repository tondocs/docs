[https://github.com/ton-blockchain/docs/blob/master/docs/overviews/Cells.md]

Ячейка

Все данные в TON хранятся в ячейках. Ячейка - это структура данных, содержащая до 1023 битов (! не байтов) данных и до 4 ссылок на другие ячейки. Биты и ссылки не смешиваются (хранятся отдельно). Циклические ссылки запрещены: для любой ячейки ни одна из ее потомков не может иметь эту ячейку в качестве ссылки. Таким образом, все ячейки представляют собой направленный ациклический граф (DAG).

Типы ячеек

В настоящее время существует 5 типов ячеек: обычные и 4 эксклюзивных. К эксклюзивным типам относятся следующие:


Обрезанная ячейка ветви
Справочная ячейка библиотеки
Подтверждающая ячейка Меркла
Ячейка обновления Меркла


Подробнее об экзотических ячейках: TVM Whitepaper, раздел 3 (EN).

Виды ячеек

Ячейка - это непрозрачный объект, оптимизированный для компактного хранения. В частности, он дедуплицирует данные: если в разных ветвях есть несколько эквивалентных подячеек, на которые ссылаются, их содержимое хранится только один раз. Однако непрозрачность означает, что ячейка не может быть изменена или прочитана напрямую. Таким образом, существует 2 дополнительных вида ячеек:


Конструктор для частично построенных ячеек, для которых могут быть определены быстрые операции добавления битовых строк, целых чисел, других ячеек и ссылок на другие ячейки.
Фрагмент для "разрезанных" ячеек, представляющий собой либо остаток частично разобранной ячейки, либо значение (подъячейку), находящееся внутри такой ячейки и извлеченное из нее инструкцией синтаксического анализа.


Сериализация данных в ячейки

Любой объект в TON (сообщение, очередь сообщений, блок, состояние всего блокчейна, код и данные контракта) сериализуется в ячейку. Процесс сериализации описывается схемой TL-B: формальное описание того, как данный объект может быть сериализован в Builder или как разобрать объект данного типа из Slice. TL-B для ячеек - это то же самое, что TL или ProtoBuf для байтовых потоков.
